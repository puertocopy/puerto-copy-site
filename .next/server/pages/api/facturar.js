"use strict";(()=>{var e={};e.id=373,e.ids=[373],e.modules={3480:(e,r,t)=>{e.exports=t(5600)},5600:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6435:(e,r)=>{Object.defineProperty(r,"M",{enumerable:!0,get:function(){return function e(r,t){return t in r?r[t]:"then"in r&&"function"==typeof r.then?r.then(r=>e(r,t)):"function"==typeof r&&"default"===t?r:void 0}}})},7773:(e,r,t)=>{t.r(r),t.d(r,{config:()=>c,default:()=>u,routeModule:()=>d});var o={};t.r(o),t.d(o,{default:()=>s});var a=t(3480),n=t(8667),i=t(6435);async function s(e,r){if("POST"!==e.method)return r.status(405).json({error:"M\xe9todo no permitido"});let{rfc:t,razonSocial:o,correo:a,codigoPostal:n,usoCfdi:i,regimenFiscal:s,ticket:u,concepto:c,precioUnitario:d}=e.body;if(!t||!o||!a||!n||!i||!s||!u||!c||!d)return r.status(400).json({error:"Faltan datos obligatorios"});let p=Buffer.from(`${process.env.FACTURAMA_USER}:${process.env.FACTURAMA_PASS}`).toString("base64"),f={Receptor:{Rfc:t,Nombre:o,UsoCfdi:i,RegimenFiscalReceptor:s,DomicilioFiscalReceptor:n},TipoDocumento:"ingreso",Conceptos:[{ClaveProdServ:"01010101",Cantidad:1,ClaveUnidad:"E48",Unidad:"Servicio",Descripcion:c,ValorUnitario:d,Importe:d,ObjetoImp:"02",Impuestos:{Traslados:[{Base:d,Impuesto:"002",TipoFactor:"Tasa",TasaOCuota:.16,Importe:+(.16*d).toFixed(2)}]}}],FormaPago:"01",MetodoPago:"PUE",Moneda:"MXN",LugarExpedicion:n};try{let e=await fetch("https://sandbox.factura.com.mx/api/v4/cfdi33/create",{method:"POST",headers:{Authorization:`Basic ${p}`,"Content-Type":"application/json"},body:JSON.stringify(f)});if(!e.ok){let t=await e.json();return r.status(400).json({error:t.Message||"Error al emitir factura"})}let t=await e.json();return r.status(200).json({success:!0,factura:t})}catch(e){return console.error("Error al facturar:",e),r.status(500).json({error:"Error interno al emitir factura"})}}let u=(0,i.M)(o,"default"),c=(0,i.M)(o,"config"),d=new a.PagesAPIRouteModule({definition:{kind:n.A.PAGES_API,page:"/api/facturar",pathname:"/api/facturar",bundlePath:"",filename:""},userland:o})},8667:(e,r)=>{Object.defineProperty(r,"A",{enumerable:!0,get:function(){return t}});var t=function(e){return e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE",e.IMAGE="IMAGE",e}({})}};var r=require("../../webpack-api-runtime.js");r.C(e);var t=r(r.s=7773);module.exports=t})();