"use strict";(()=>{var e={};e.id=360,e.ids=[360],e.modules={3480:(e,r,t)=>{e.exports=t(5600)},4001:(e,r,t)=>{t.r(r),t.d(r,{config:()=>u,default:()=>c,routeModule:()=>d});var o={};t.r(o),t.d(o,{default:()=>i});var a=t(3480),n=t(8667),s=t(6435);async function i(e,r){if("POST"!==e.method)return r.status(405).json({error:"M\xe9todo no permitido"});let{ticket:t,rfc:o,razonSocial:a,correo:n,cp:s,usoCfdi:i,regimenFiscal:c}=e.body;if(!o||!a||!n||!s||!t||!i||!c)return r.status(400).json({error:"❌ Faltan campos requeridos"});let u={Receptor:{Rfc:o,Nombre:a,DomicilioFiscalReceptor:s,RegimenFiscalReceptor:c,UsoCFDI:i},TipoDeComprobante:"I",Exportacion:"01",MetodoPago:"PUE",FormaPago:"01",Serie:"A",Folio:`${t}`,LugarExpedicion:s,CfdiRelacionados:[],Conceptos:[{ClaveProdServ:"01010101",Cantidad:1,ClaveUnidad:"E48",Unidad:"Servicio",Descripcion:`Venta en mostrador Ticket ${t}`,ValorUnitario:100,Importe:100,ObjetoImp:"02",Impuestos:{Traslados:[{Base:100,Impuesto:"002",TipoFactor:"Tasa",TasaOCuota:.16,Importe:16}]}}],Impuestos:{TotalImpuestosTrasladados:16,Traslados:[{Impuesto:"002",TipoFactor:"Tasa",TasaOCuota:.16,Importe:16}]},SubTotal:100,Total:116};try{let e=process.env.FACTURA_COM_API_BASE_URL||"https://sandbox.factura.com/api/v4/cfdi40/create",t=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json","api-key":process.env.FACTURA_COM_API_KEY||"","api-secret":process.env.FACTURA_COM_API_SECRET||""},body:JSON.stringify(u)});if(!t.ok){let e=await t.text();return console.error("❌ Error Factura.com:",e),r.status(t.status).json({error:"❌ Error al conectar con Factura.com",detalle:e})}let o=await t.json();return r.status(200).json({success:!0,factura:o})}catch(e){return console.error("❌ Error general:",e),r.status(500).json({error:"❌ Error general",detalle:e.message})}}let c=(0,s.M)(o,"default"),u=(0,s.M)(o,"config"),d=new a.PagesAPIRouteModule({definition:{kind:n.A.PAGES_API,page:"/api/generar-factura",pathname:"/api/generar-factura",bundlePath:"",filename:""},userland:o})},5600:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6435:(e,r)=>{Object.defineProperty(r,"M",{enumerable:!0,get:function(){return function e(r,t){return t in r?r[t]:"then"in r&&"function"==typeof r.then?r.then(r=>e(r,t)):"function"==typeof r&&"default"===t?r:void 0}}})},8667:(e,r)=>{Object.defineProperty(r,"A",{enumerable:!0,get:function(){return t}});var t=function(e){return e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE",e.IMAGE="IMAGE",e}({})}};var r=require("../../webpack-api-runtime.js");r.C(e);var t=r(r.s=4001);module.exports=t})();